import{i as te,j as ue}from"./index-C9xbQxJ_.js";var re={exports:{}},q={},k={};(function(){var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];function e(a){var f,d=new Uint8Array(a);for(f=0;f<a;f+=1)d[f]=0;return d}function r(a,f,d,l){var u=f+d,g=e((parseInt(u/l)+1)*l);return g.set(a),g}function n(a,f,d){return a=a.toString(d||8),"000000000000".substr(a.length+12-f)+a}function i(a,f,d){var l,u;for(f=f||e(a.length),d=d||0,l=0,u=a.length;l<u;l+=1)f[d]=a.charCodeAt(l),d+=1;return f}function c(a){var f,d=a.length%3,l="",u,g;function o(w){return t[w>>18&63]+t[w>>12&63]+t[w>>6&63]+t[w&63]}for(f=0,g=a.length-d;f<g;f+=3)u=(a[f]<<16)+(a[f+1]<<8)+a[f+2],l+=o(u);switch(l.length%4){case 1:l+="=";break;case 2:l+="==";break}return l}function s(a){for(var f=a.match(/^([^=]+)/)[1],d=a.match(/(=*)$/)[1].length,l=0,u=f.length,g,o=0,w=e(f.length*.75+d);l<u;)g=0,g|=t.indexOf(f.charAt(l)||"A")<<18,l+=1,g|=t.indexOf(f.charAt(l)||"A")<<12,l+=1,g|=t.indexOf(f.charAt(l)||"A")<<6,l+=1,g|=t.indexOf(f.charAt(l)||"A"),l+=1,w[o]=g>>16&255,o+=1,w[o]=g>>8&255,o+=1,w[o]=g&255,o+=1;return w}k.clean=e,k.pad=n,k.extend=r,k.stringToUint8=i,k.uint8ToBase64=c,k.base64ToUint8=s})();(function(){var t=k,e;e=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}];function r(n,i){var c=t.clean(512),s=0;return e.forEach(function(a){var f=n[a.field]||"",d,l;for(d=0,l=f.length;d<l;d+=1)c[s]=f.charCodeAt(d),s+=1;s+=a.length-d}),typeof i=="function"?i(c,s):c}q.structure=e,q.format=r})();(function(){var t=q,e=k,r=512,n;function i(c){this.written=0,n=(c||20)*r,this.out=e.clean(n)}i.prototype.append=function(c,s,a,f){var d,l,u,g,o,w,h;if(typeof s=="string")s=e.stringToUint8(s);else if(s.constructor!==Uint8Array.prototype.constructor)throw"Invalid input type. You gave me: "+s.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/)[1];return typeof a=="function"&&(f=a,a={}),a=a||{},u=a.mode||parseInt("777",8)&4095,g=a.mtime||Math.floor(+new Date/1e3),o=a.uid||0,w=a.gid||0,d={fileName:c,fileMode:e.pad(u,7),uid:e.pad(o,7),gid:e.pad(w,7),fileSize:e.pad(s.length,11),mtime:e.pad(g,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:a.owner||"",group:a.group||""},l=0,Object.keys(d).forEach(function(m){var y,B=d[m],b;for(y=0,b=B.length;y<b;y+=1)l+=B.charCodeAt(y)}),d.checksum=e.pad(l,6)+"\0 ",h=t.format(d),this.out.set(h,this.written),this.written+=h.length,this.written+s.length>this.out.length&&(this.out=e.extend(this.out,this.written,s.length,n)),this.out.set(s,this.written),this.written+=s.length+(r-(s.length%r||r)),this.out.length-this.written<r*2&&(this.out=e.extend(this.out,this.written,r*2,n)),typeof f=="function"&&f(this.out),this.out},i.prototype.clear=function(){this.written=0,this.out=e.clean(n)},i.utils=e,i.stringToUint8=e.stringToUint8,i.uint8ToBase64=e.uint8ToBase64,i.base64ToUint8=e.base64ToUint8,re.exports=i})();var he=re.exports;const He=te(he);var ne={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(ue,function(){function r(d){function l(h){for(var m=0,y=u.length;m<y;++m)u[m](h);g.push(h)}if(typeof Promise!="function")throw new Error("Promise implementation not available in this environment.");var u=[],g=[],o=new Promise(function(h,m){d(h,m,l)});o.progress=function(h){if(typeof h!="function")throw new Error("cb is not a function.");for(var m=0,y=g.length;m<y;++m)h(g[m]);return u.push(h),o};var w=o.then;return o.then=function(h,m,y){return w.call(o,h,m),y!==void 0&&o.progress(y),o},o}function n(d){if(!(d instanceof ArrayBuffer))throw new TypeError("arrayBuffer is not an instance of ArrayBuffer.");if(!s.Worker)throw new Error("Worker implementation is not available in this environment.");return new r(function(l,u,g){var o=new Worker(c),w=[];o.onerror=function(h){u(h)},o.onmessage=function(h){switch(h=h.data,h.type){case"log":console[h.data.level]("Worker: "+h.data.msg);break;case"extract":var m=i(h.data);w.push(m),g(m);break;case"complete":o.terminate(),l(w);break;case"error":o.terminate(),u(new Error(h.data.message));break;default:o.terminate(),u(new Error("Unknown message from worker: "+h.type))}},o.postMessage({type:"extract",buffer:d},[d])})}function i(d){return Object.defineProperties(d,f),d}var c,s=window||this,a=s.URL||s.webkitURL,f={blob:{get:function(){return this._blob||(this._blob=new Blob([this.buffer]))}},getBlobUrl:{value:function(){return this._blobUrl||(this._blobUrl=a.createObjectURL(this.blob))}},readAsString:{value:function(){for(var d=this.buffer,l=d.byteLength,u=1,g=new DataView(d),o=[],w=0;w<l;++w){var h=g.getUint8(w*u,!0);o.push(h)}return this._string=String.fromCharCode.apply(null,o)}},readAsJSON:{value:function(){return JSON.parse(this.readAsString())}}};return c=(window||this).URL.createObjectURL(new Blob(['"use strict";function UntarWorker(){}function decodeUTF8(e){for(var r="",t=0;t<e.length;){var a=e[t++];if(a>127){if(a>191&&a<224){if(t>=e.length)throw"UTF-8 decode: incomplete 2-byte sequence";a=(31&a)<<6|63&e[t]}else if(a>223&&a<240){if(t+1>=e.length)throw"UTF-8 decode: incomplete 3-byte sequence";a=(15&a)<<12|(63&e[t])<<6|63&e[++t]}else{if(!(a>239&&a<248))throw"UTF-8 decode: unknown multibyte start 0x"+a.toString(16)+" at index "+(t-1);if(t+2>=e.length)throw"UTF-8 decode: incomplete 4-byte sequence";a=(7&a)<<18|(63&e[t])<<12|(63&e[++t])<<6|63&e[++t]}++t}if(a<=65535)r+=String.fromCharCode(a);else{if(!(a<=1114111))throw"UTF-8 decode: code point 0x"+a.toString(16)+" exceeds UTF-16 reach";a-=65536,r+=String.fromCharCode(a>>10|55296),r+=String.fromCharCode(1023&a|56320)}}return r}function PaxHeader(e){this._fields=e}function TarFile(){}function UntarStream(e){this._bufferView=new DataView(e),this._position=0}function UntarFileStream(e){this._stream=new UntarStream(e),this._globalPaxHeader=null}if(UntarWorker.prototype={onmessage:function(e){try{if("extract"!==e.data.type)throw new Error("Unknown message type: "+e.data.type);this.untarBuffer(e.data.buffer)}catch(r){this.postError(r)}},postError:function(e){this.postMessage({type:"error",data:{message:e.message}})},postLog:function(e,r){this.postMessage({type:"log",data:{level:e,msg:r}})},untarBuffer:function(e){try{for(var r=new UntarFileStream(e);r.hasNext();){var t=r.next();this.postMessage({type:"extract",data:t},[t.buffer])}this.postMessage({type:"complete"})}catch(a){this.postError(a)}},postMessage:function(e,r){self.postMessage(e,r)}},"undefined"!=typeof self){var worker=new UntarWorker;self.onmessage=function(e){worker.onmessage(e)}}PaxHeader.parse=function(e){for(var r=new Uint8Array(e),t=[];r.length>0;){var a=parseInt(decodeUTF8(r.subarray(0,r.indexOf(32)))),n=decodeUTF8(r.subarray(0,a)),i=n.match(/^\\d+ ([^=]+)=(.*)\\n$/);if(null===i)throw new Error("Invalid PAX header data format.");var s=i[1],o=i[2];0===o.length?o=null:null!==o.match(/^\\d+$/)&&(o=parseInt(o));var f={name:s,value:o};t.push(f),r=r.subarray(a)}return new PaxHeader(t)},PaxHeader.prototype={applyHeader:function(e){this._fields.forEach(function(r){var t=r.name,a=r.value;"path"===t?(t="name",void 0!==e.prefix&&delete e.prefix):"linkpath"===t&&(t="linkname"),null===a?delete e[t]:e[t]=a})}},UntarStream.prototype={readString:function(e){for(var r=1,t=e*r,a=[],n=0;n<e;++n){var i=this._bufferView.getUint8(this.position()+n*r,!0);if(0===i)break;a.push(i)}return this.seek(t),String.fromCharCode.apply(null,a)},readBuffer:function(e){var r;if("function"==typeof ArrayBuffer.prototype.slice)r=this._bufferView.buffer.slice(this.position(),this.position()+e);else{r=new ArrayBuffer(e);var t=new Uint8Array(r),a=new Uint8Array(this._bufferView.buffer,this.position(),e);t.set(a)}return this.seek(e),r},seek:function(e){this._position+=e},peekUint32:function(){return this._bufferView.getUint32(this.position(),!0)},position:function(e){return void 0===e?this._position:void(this._position=e)},size:function(){return this._bufferView.byteLength}},UntarFileStream.prototype={hasNext:function(){return this._stream.position()+4<this._stream.size()&&0!==this._stream.peekUint32()},next:function(){return this._readNextFile()},_readNextFile:function(){var e=this._stream,r=new TarFile,t=!1,a=null,n=e.position(),i=n+512;switch(r.name=e.readString(100),r.mode=e.readString(8),r.uid=parseInt(e.readString(8)),r.gid=parseInt(e.readString(8)),r.size=parseInt(e.readString(12),8),r.mtime=parseInt(e.readString(12),8),r.checksum=parseInt(e.readString(8)),r.type=e.readString(1),r.linkname=e.readString(100),r.ustarFormat=e.readString(6),r.ustarFormat.indexOf("ustar")>-1&&(r.version=e.readString(2),r.uname=e.readString(32),r.gname=e.readString(32),r.devmajor=parseInt(e.readString(8)),r.devminor=parseInt(e.readString(8)),r.namePrefix=e.readString(155),r.namePrefix.length>0&&(r.name=r.namePrefix+"/"+r.name)),e.position(i),r.type){case"0":case"":r.buffer=e.readBuffer(r.size);break;case"1":break;case"2":break;case"3":break;case"4":break;case"5":break;case"6":break;case"7":break;case"g":t=!0,this._globalPaxHeader=PaxHeader.parse(e.readBuffer(r.size));break;case"x":t=!0,a=PaxHeader.parse(e.readBuffer(r.size))}void 0===r.buffer&&(r.buffer=new ArrayBuffer(0));var s=i+r.size;return r.size%512!==0&&(s+=512-r.size%512),e.position(s),t&&(r=this._readNextFile()),null!==this._globalPaxHeader&&this._globalPaxHeader.applyHeader(r),null!==a&&a.applyHeader(r),r}};'])),n})})(ne);var pe=ne.exports;const $e=te(pe);function ie(t){return t.arrayBuffer?t.arrayBuffer():new Promise((e,r)=>{const n=new FileReader;n.addEventListener("loadend",()=>{e(n.result)}),n.addEventListener("error",r),n.readAsArrayBuffer(t)})}async function me(t){const e=await ie(t);return new Uint8Array(e)}function ae(t){return typeof Blob<"u"&&t instanceof Blob}function O(t){return typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}const ge=typeof process<"u"&&process.versions&&typeof process.versions.node<"u"&&typeof process.versions.electron>"u";function we(t){return t.byteOffset===0&&t.byteLength===t.buffer.byteLength}class J{constructor(e){this.typedArray=e instanceof ArrayBuffer||O(e)?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}async getLength(){return this.typedArray.byteLength}async read(e,r){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+e,r)}}class Q{constructor(e){this.blob=e}async getLength(){return this.blob.size}async read(e,r){const n=this.blob.slice(e,e+r),i=await ie(n);return new Uint8Array(i)}async sliceAsBlob(e,r,n=""){return this.blob.slice(e,e+r,n)}}function ye(t,e){var r=Uint8Array;if(t[0]==3&&t[1]==0)return e||new r(0);var n=be,i=oe,c=ve,s=se,a=e==null;a&&(e=new r(t.length>>>2<<3));for(var f=0,d=0,l=0,u=0,g=0,o=0,w=0,h=0,m=0,y,B;f==0;){if(f=n(t,m,1),d=n(t,m+1,2),m+=3,d==0){m&7&&(m+=8-(m&7));var b=(m>>>3)+4,S=t[b-4]|t[b-3]<<8;a&&(e=$(e,h+S)),e.set(new r(t.buffer,t.byteOffset+b,S),h),m=b+S<<3,h+=S;continue}if(a&&(e=$(e,h+(1<<17))),d==1&&(y=p.flmap,B=p.fdmap,o=511,w=31),d==2){l=i(t,m,5)+257,u=i(t,m+5,5)+1,g=i(t,m+10,4)+4,m+=14;for(var v=0;v<38;v+=2)p.itree[v]=0,p.itree[v+1]=0;for(var U=1,v=0;v<g;v++){var D=i(t,m+v*3,3);p.itree[(p.ordr[v]<<1)+1]=D,D>U&&(U=D)}m+=3*g,F(p.itree,U),L(p.itree,U,p.imap),y=p.lmap,B=p.dmap,m=c(p.imap,(1<<U)-1,l+u,t,m,p.ttree);var R=K(p.ttree,0,l,p.ltree);o=(1<<R)-1;var M=K(p.ttree,l,u,p.dtree);w=(1<<M)-1,F(p.ltree,R),L(p.ltree,R,y),F(p.dtree,M),L(p.dtree,M,B)}for(;;){var G=y[s(t,m)&o];m+=G&15;var E=G>>>4;if(!(E>>>8))e[h++]=E;else{if(E==256)break;var P=h+E-254;if(E>264){var I=p.ldef[E-257];P=h+(I>>>3)+i(t,m,I&7),m+=I&7}var Y=B[s(t,m)&w];m+=Y&15;var de=Y>>>4,H=p.ddef[de],C=(H>>>4)+n(t,m,H&15);for(m+=H&15,a&&(e=$(e,h+(1<<17)));h<P;)e[h]=e[h++-C],e[h]=e[h++-C],e[h]=e[h++-C],e[h]=e[h++-C];h=P}}}return e.length==h?e:e.slice(0,h)}function $(t,e){var r=t.length;if(e<=r)return t;var n=new Uint8Array(Math.max(r<<1,e));return n.set(t,0),n}function ve(t,e,r,n,i,c){for(var s=oe,a=se,f=0;f<r;){var d=t[a(n,i)&e];i+=d&15;var l=d>>>4;if(l<=15)c[f]=l,f++;else{var u=0,g=0;l==16?(g=3+s(n,i,2),i+=2,u=c[f-1]):l==17?(g=3+s(n,i,3),i+=3):l==18&&(g=11+s(n,i,7),i+=7);for(var o=f+g;f<o;)c[f]=u,f++}}return i}function K(t,e,r,n){for(var i=0,c=0,s=n.length>>>1;c<r;){var a=t[c+e];n[c<<1]=0,n[(c<<1)+1]=a,a>i&&(i=a),c++}for(;c<s;)n[c<<1]=0,n[(c<<1)+1]=0,c++;return i}function F(t,e){for(var r=t.length,n,i,c,s,a,f=p.bl_count,s=0;s<=e;s++)f[s]=0;for(s=1;s<r;s+=2)f[t[s]]++;var d=p.next_code;for(n=0,f[0]=0,i=1;i<=e;i++)n=n+f[i-1]<<1,d[i]=n;for(c=0;c<r;c+=2)a=t[c+1],a!=0&&(t[c]=d[a],d[a]++)}function L(t,e,r){for(var n=t.length,i=p.rev15,c=0;c<n;c+=2)if(t[c+1]!=0)for(var s=c>>1,a=t[c+1],f=s<<4|a,d=e-a,l=t[c]<<d,u=l+(1<<d);l!=u;){var g=i[l]>>>15-e;r[g]=f,l++}}function X(t,e){for(var r=p.rev15,n=15-e,i=0;i<t.length;i+=2){var c=t[i]<<e-t[i+1];t[i]=r[c]>>>n}}function oe(t,e,r){return(t[e>>>3]|t[(e>>>3)+1]<<8)>>>(e&7)&(1<<r)-1}function be(t,e,r){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(e&7)&(1<<r)-1}function se(t,e){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(e&7)}const p=function(){var t=Uint16Array,e=Uint32Array;return{next_code:new t(16),bl_count:new t(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new t(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new t(512),fltree:[],fdmap:new t(32),fdtree:[],lmap:new t(32768),ltree:[],ttree:[],dmap:new t(32768),dtree:[],imap:new t(512),itree:[],rev15:new t(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new t(65536),prev:new t(32768)}}();(function(){for(var t=32768,e=0;e<t;e++){var r=e;r=(r&2863311530)>>>1|(r&1431655765)<<1,r=(r&3435973836)>>>2|(r&858993459)<<2,r=(r&4042322160)>>>4|(r&252645135)<<4,r=(r&4278255360)>>>8|(r&16711935)<<8,p.rev15[e]=(r>>>16|r<<16)>>>17}function n(i,c,s){for(;c--!=0;)i.push(0,s)}for(var e=0;e<32;e++)p.ldef[e]=p.of0[e]<<3|p.exb[e],p.ddef[e]=p.df0[e]<<4|p.dxb[e];n(p.fltree,144,8),n(p.fltree,112,9),n(p.fltree,24,7),n(p.fltree,8,8),F(p.fltree,9),L(p.fltree,9,p.flmap),X(p.fltree,9),n(p.fdtree,32,5),F(p.fdtree,5),L(p.fdtree,5,p.fdmap),X(p.fdtree,5),n(p.itree,19,0),n(p.ltree,286,0),n(p.dtree,30,0),n(p.ttree,320,0)})();const V={table:function(){for(var t=new Uint32Array(256),e=0;e<256;e++){for(var r=e,n=0;n<8;n++)r&1?r=3988292384^r>>>1:r=r>>>1;t[e]=r}return t}(),update:function(t,e,r,n){for(var i=0;i<n;i++)t=V.table[(t^e[r+i])&255]^t>>>8;return t},crc:function(t,e,r){return V.update(4294967295,t,e,r)^4294967295}};function xe(t,e){return ye(t,e)}const ee={numWorkers:1,workerURL:"",useWorkers:!1};let Ae=0;const N=[];function W(t){return new Promise((e,r)=>{const n=new Worker(t);n.onmessage=i=>{i.data==="start"?(n.onerror=void 0,n.onmessage=void 0,e(n)):r(new Error(`unexpected message: ${i.data}`))},n.onerror=r})}function Se(t,e){return t.require?t.require(e):{}}(function(){if(ge){const{Worker:t}=Se(module,"worker_threads");return{async createWorker(e){return new t(e)},addEventListener(e,r){e.on("message",n=>{r({target:e,data:n})})},async terminate(e){await e.terminate()}}}else return{async createWorker(t){try{return await W(t)}catch{console.warn("could not load worker:",t)}let e;try{const r=await fetch(t,{mode:"cors"});if(!r.ok)throw new Error(`could not load: ${t}`);e=await r.text(),t=URL.createObjectURL(new Blob([e],{type:"application/javascript"}));const n=await W(t);return ee.workerURL=t,n}catch{console.warn("could not load worker via fetch:",t)}if(e!==void 0)try{t=`data:application/javascript;base64,${btoa(e)}`;const r=await W(t);return ee.workerURL=t,r}catch{console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(t,e){t.addEventListener("message",e)},async terminate(t){t.terminate()}}})();function Ue(t,e,r,n){const i=new Uint8Array(e);xe(t,i),n(r?new Blob([i],{type:r}):i.buffer)}async function Be(){if(N.length!==0)for(;N.length;){const{src:t,uncompressedSize:e,type:r,resolve:n}=N.shift();let i=t;ae(t)&&(i=await me(t)),Ue(i,e,r,n)}}function fe(t,e,r){return new Promise((n,i)=>{N.push({src:t,uncompressedSize:e,type:r,resolve:n,reject:i,id:Ae++}),Be()})}function ke(t,e){const r=t&31,n=(t>>5&15)-1,i=(t>>9&127)+1980,c=0,s=(e&31)*2,a=e>>5&63,f=e>>11&31;return new Date(i,n,r,f,a,s,c)}class ze{constructor(e,r){this._reader=e,this._rawEntry=r,this.name=r.name,this.nameBytes=r.nameBytes,this.size=r.uncompressedSize,this.compressedSize=r.compressedSize,this.comment=r.comment,this.commentBytes=r.commentBytes,this.compressionMethod=r.compressionMethod,this.lastModDate=ke(r.lastModFileDate,r.lastModFileTime),this.isDirectory=r.uncompressedSize===0&&r.name.endsWith("/"),this.encrypted=!!(r.generalPurposeBitFlag&1),this.externalFileAttributes=r.externalFileAttributes,this.versionMadeBy=r.versionMadeBy}async blob(e="application/octet-stream"){return await Me(this._reader,this._rawEntry,e)}async arrayBuffer(){return await Re(this._reader,this._rawEntry)}async text(){const e=await this.arrayBuffer();return T(new Uint8Array(e))}async json(){const e=await this.text();return JSON.parse(e)}}const j=22,Ee=65535,_e=101010256,Fe=101075792;async function _(t,e,r){return await t.read(e,r)}async function Z(t,e,r,n){return t.sliceAsBlob?await t.sliceAsBlob(e,r,n):await t.read(e,r)}const Le={unsigned(){return 0}};function x(t,e){return t[e]+t[e+1]*256}function A(t,e){return t[e]+t[e+1]*256+t[e+2]*65536+t[e+3]*16777216}function z(t,e){return A(t,e)+A(t,e+4)*4294967296}const Te=new TextDecoder;function T(t,e){return O(t.buffer)&&(t=new Uint8Array(t)),Te.decode(t)}async function Oe(t,e){const r=Math.min(j+Ee,e),n=e-r,i=await _(t,n,r);for(let c=r-j;c>=0;--c){if(A(i,c)!==_e)continue;const s=new Uint8Array(i.buffer,i.byteOffset+c,i.byteLength-c),a=x(s,4);if(a!==0)throw new Error(`multi-volume zip files are not supported. This is volume: ${a}`);const f=x(s,10),d=A(s,12),l=A(s,16),u=x(s,20),g=s.length-j;if(u!==g)throw new Error(`invalid comment length. expected: ${g}, actual: ${u}`);const o=new Uint8Array(s.buffer,s.byteOffset+22,u),w=T(o);return f===65535||l===4294967295?await Ne(t,n+c,w,o):await ce(t,l,d,f,w,o)}throw new Error("could not find end of central directory. maybe not zip file")}const Ce=117853008;async function Ne(t,e,r,n){const i=e-20,c=await _(t,i,20);if(A(c,0)!==Ce)throw new Error("invalid zip64 end of central directory locator signature");const s=z(c,8),a=await _(t,s,56);if(A(a,0)!==Fe)throw new Error("invalid zip64 end of central directory record signature");const f=z(a,32),d=z(a,40),l=z(a,48);return ce(t,l,d,f,r,n)}const De=33639248;async function ce(t,e,r,n,i,c){let s=0;const a=await _(t,e,r),f=[];for(let l=0;l<n;++l){const u=a.subarray(s,s+46),g=A(u,0);if(g!==De)throw new Error(`invalid central directory file header signature: 0x${g.toString(16)}`);const o={versionMadeBy:x(u,4),versionNeededToExtract:x(u,6),generalPurposeBitFlag:x(u,8),compressionMethod:x(u,10),lastModFileTime:x(u,12),lastModFileDate:x(u,14),crc32:A(u,16),compressedSize:A(u,20),uncompressedSize:A(u,24),fileNameLength:x(u,28),extraFieldLength:x(u,30),fileCommentLength:x(u,32),internalFileAttributes:x(u,36),externalFileAttributes:A(u,38),relativeOffsetOfLocalHeader:A(u,42)};if(o.generalPurposeBitFlag&64)throw new Error("strong encryption is not supported");s+=46;const w=a.subarray(s,s+o.fileNameLength+o.extraFieldLength+o.fileCommentLength);o.nameBytes=w.slice(0,o.fileNameLength),o.name=T(o.nameBytes);const h=o.fileNameLength+o.extraFieldLength,m=w.slice(o.fileNameLength,h);o.extraFields=[];let y=0;for(;y<m.length-3;){const b=x(m,y+0),S=x(m,y+2),v=y+4,U=v+S;if(U>m.length)throw new Error("extra field length exceeds extra field buffer size");o.extraFields.push({id:b,data:m.slice(v,U)}),y=U}if(o.commentBytes=w.slice(h,h+o.fileCommentLength),o.comment=T(o.commentBytes),s+=w.length,o.uncompressedSize===4294967295||o.compressedSize===4294967295||o.relativeOffsetOfLocalHeader===4294967295){const b=o.extraFields.find(U=>U.id===1);if(!b)throw new Error("expected zip64 extended information extra field");const S=b.data;let v=0;if(o.uncompressedSize===4294967295){if(v+8>S.length)throw new Error("zip64 extended information extra field does not include uncompressed size");o.uncompressedSize=z(S,v),v+=8}if(o.compressedSize===4294967295){if(v+8>S.length)throw new Error("zip64 extended information extra field does not include compressed size");o.compressedSize=z(S,v),v+=8}if(o.relativeOffsetOfLocalHeader===4294967295){if(v+8>S.length)throw new Error("zip64 extended information extra field does not include relative header offset");o.relativeOffsetOfLocalHeader=z(S,v),v+=8}}const B=o.extraFields.find(b=>b.id===28789&&b.data.length>=6&&b.data[0]===1&&A(b.data,1),Le.unsigned(o.nameBytes));if(B&&(o.fileName=T(B.data.slice(5))),o.compressionMethod===0){let b=o.uncompressedSize;if(o.generalPurposeBitFlag&1&&(b+=12),o.compressedSize!==b)throw new Error(`compressed size mismatch for stored file: ${o.compressedSize} != ${b}`)}f.push(o)}return{zip:{comment:i,commentBytes:c},entries:f.map(l=>new ze(t,l))}}async function le(t,e){if(e.generalPurposeBitFlag&1)throw new Error("encrypted entries not supported");const r=await _(t,e.relativeOffsetOfLocalHeader,30),n=await t.getLength(),i=A(r,0);if(i!==67324752)throw new Error(`invalid local file header signature: 0x${i.toString(16)}`);const c=x(r,26),s=x(r,28),a=e.relativeOffsetOfLocalHeader+r.length+c+s;let f;if(e.compressionMethod===0)f=!1;else if(e.compressionMethod===8)f=!0;else throw new Error(`unsupported compression method: ${e.compressionMethod}`);const d=a,l=d+e.compressedSize;if(e.compressedSize!==0&&l>n)throw new Error(`file data overflows file bounds: ${d} +  ${e.compressedSize}  > ${n}`);return{decompress:f,fileDataStart:d}}async function Re(t,e){const{decompress:r,fileDataStart:n}=await le(t,e);if(!r){const s=await _(t,n,e.compressedSize);return we(s)?s.buffer:s.slice().buffer}const i=await Z(t,n,e.compressedSize);return await fe(i,e.uncompressedSize)}async function Me(t,e,r){const{decompress:n,fileDataStart:i}=await le(t,e);if(!n){const a=await Z(t,i,e.compressedSize,r);return ae(a)?a:new Blob([O(a.buffer)?new Uint8Array(a):a],{type:r})}const c=await Z(t,i,e.compressedSize);return await fe(c,e.uncompressedSize,r)}async function Pe(t){let e;if(typeof Blob<"u"&&t instanceof Blob)e=new Q(t);else if(t instanceof ArrayBuffer||t&&t.buffer&&t.buffer instanceof ArrayBuffer)e=new J(t);else if(O(t)||O(t.buffer))e=new J(t);else if(typeof t=="string"){const n=await fetch(t);if(!n.ok)throw new Error(`failed http request ${t}, status: ${n.status}: ${n.statusText}`);const i=await n.blob();e=new Q(i)}else if(typeof t.getLength=="function"&&typeof t.read=="function")e=t;else throw new Error("unsupported source type");const r=await e.getLength();if(r>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${r}. Only file sizes up 4503599627370496 bytes are supported`);return await Oe(e,r)}async function We(t){const{zip:e,entries:r}=await Pe(t);return{zip:e,entries:Object.fromEntries(r.map(n=>[n.name,n]))}}export{He as T,$e as a,We as u};
