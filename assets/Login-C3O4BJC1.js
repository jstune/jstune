import{T as w}from"./TemplateSetup-ek5z94wm.js";import{_ as v,c as b,w as a,r as d,o as n,e as u,v as p,b as o,g as m,h as k,F as y,a as h,d as g,t as $}from"./index-BG_EExy9.js";import"./UtilityNavbar-DnfMN3fm.js";import"./TemplateDefault-CtmB-jvh.js";const _={components:{TemplateSetup:w},inject:["io","server","user","userUpdate"],data:()=>({email:"",password:"",providers:[]}),async created(){await this.getLoginProviders()},async mounted(){var t,e;(e=(t=this.$refs)==null?void 0:t.username)==null||e.focus()},methods:{async redirect(t){let e=this.server;(e==="/"||!e)&&(e=location.origin);const r=e.endsWith("/")?`oauth/${t}`:`/oauth/${t}`,l=encodeURIComponent(`${e}${r}/callback?app_url=${location.origin}`);location.href=e+r+`?redirect_uri=${l}`},async getLoginProviders(){try{await this.io.logout(),this.providers=await this.io.service("oauth_login").find()}catch(t){console.log("error",t)}},async login(t){this.io.authenticate({strategy:"local",...t}).then(e=>{this.userUpdate(e==null?void 0:e.user),this.$router.push("/dashboard")}).catch(e=>{console.error("Authentication error",e),alert(e.message)})}}},x=o("h2",{class:"mb-2"}," JSTune ",-1),T=["onClick"];function C(t,e,r,l,L,i){const c=d("router-link"),f=d("TemplateSetup");return n(),b(f,null,{default:a(()=>[x,u(o("input",{ref:"username","onUpdate:modelValue":e[0]||(e[0]=s=>t.email=s),class:"mb-3 font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Username"},null,512),[[p,t.email]]),u(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.password=s),class:"font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Password",type:"password"},null,512),[[p,t.password]]),o("button",{onClick:e[2]||(e[2]=s=>i.login({email:t.email,password:t.password})),class:"hover:bg-fuchsia-950 mt-4 mb-2 rounded-lg bg-fuchsia-900 w-full p-3"}," Login "),(n(!0),m(y,null,k(t.providers,s=>(n(),m("button",{onClick:S=>i.redirect(s),class:"hover:bg-sky-800 bg-sky-700 mt-2 rounded-lg w-full p-3"}," Login with "+$(s),9,T))),256)),h(c,{to:"/recover",class:"hover:text-slate-200 mt-6 inline-block text-center w-full"},{default:a(()=>[g(" Recover lost password ")]),_:1}),h(c,{to:"/register",class:"mt-3 hover:text-slate-200 inline-block text-center w-full"},{default:a(()=>[g(" Request access ")]),_:1})]),_:1})}const P=v(_,[["render",C]]);export{P as default};
