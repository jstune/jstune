import{T as f}from"./TemplateSetup-UCfajeyk.js";import{_ as w,c as v,w as a,r as u,o as r,e as d,v as c,b as o,g as p,h as b,F as y,a as m,d as h,t as k}from"./index-BKYGmNch.js";import"./UtilityNavbar-B_xm-8mo.js";import"./TemplateDefault-BXVE7adv.js";const _={components:{TemplateSetup:f},inject:["io","server","user","userUpdate"],data:()=>({email:"",password:"",providers:[]}),async created(){await this.getLoginProviders()},async mounted(){var t,e;(e=(t=this.$refs)==null?void 0:t.username)==null||e.focus()},methods:{async redirect(t){let e=this.server;(e==="/"||!e)&&(e=location.origin);const n=e.endsWith("/")?`oauth/${t}`:`/oauth/${t}`;location.href=e+n+`?app_url=${location.origin}`},async getLoginProviders(){try{await this.io.logout(),this.providers=await this.io.service("oauth_login").find()}catch(t){console.log("error",t)}},async login(t){this.io.authenticate({strategy:"local",...t}).then(e=>{this.userUpdate(e==null?void 0:e.user),this.$router.push("/dashboard")}).catch(e=>{console.error("Authentication error",e),alert(e.message)})}}},x=o("h2",{class:"mb-2"}," JSTune ",-1),$=["onClick"];function T(t,e,n,L,S,l){const i=u("router-link"),g=u("TemplateSetup");return r(),v(g,null,{default:a(()=>[x,d(o("input",{ref:"username","onUpdate:modelValue":e[0]||(e[0]=s=>t.email=s),class:"mb-3 font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Username"},null,512),[[c,t.email]]),d(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.password=s),class:"font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Password",type:"password"},null,512),[[c,t.password]]),o("button",{onClick:e[2]||(e[2]=s=>l.login({email:t.email,password:t.password})),class:"hover:bg-fuchsia-950 mt-4 mb-2 rounded-lg bg-fuchsia-900 w-full p-3"}," Login "),(r(!0),p(y,null,b(t.providers,s=>(r(),p("button",{onClick:C=>l.redirect(s),class:"hover:bg-sky-800 bg-sky-700 mt-2 rounded-lg w-full p-3"}," Login with "+k(s),9,$))),256)),m(i,{to:"/recover",class:"hover:text-slate-200 mt-6 inline-block text-center w-full"},{default:a(()=>[h(" Recover lost password ")]),_:1}),m(i,{to:"/register",class:"mt-3 hover:text-slate-200 inline-block text-center w-full"},{default:a(()=>[h(" Request access ")]),_:1})]),_:1})}const P=w(_,[["render",T]]);export{P as default};
