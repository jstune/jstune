import{T as w}from"./TemplateSetup-Bj91DTjR.js";import{_ as v,c as $,w as r,r as c,o as n,e as d,v as p,b as a,g as h,h as b,F as k,a as m,d as g,t as y}from"./index-BiY3e__d.js";import"./UtilityNavbar-RnIx3xlW.js";import"./TemplateDefault-BdeUGciy.js";const _={components:{TemplateSetup:w},inject:["io","server","user","userUpdate"],data:()=>({email:"",password:"",providers:[]}),async created(){await this.getLoginProviders()},async mounted(){var t,e;(e=(t=this.$refs)==null?void 0:t.username)==null||e.focus()},methods:{async redirect(t){let e=this.server;(e==="/"||!e)&&(e=location.origin);const o=e.endsWith("/")?`oauth/${t}`:`/oauth/${t}`,l=encodeURIComponent(`${e}${o}/callback?app_url=${location.origin}`);location.href=e+o+`?redirect_uri=${l}`,this.server.endsWith("/")?`${t}`:`${t}`,this.server+o+`?app_url=${location.origin}`},async getLoginProviders(){try{await this.io.logout(),this.providers=await this.io.service("oauth_login").find()}catch(t){console.log("error",t)}},async login(t){this.io.authenticate({strategy:"local",...t}).then(e=>{this.userUpdate(e==null?void 0:e.user),this.$router.push("/dashboard")}).catch(e=>{console.error("Authentication error",e),alert(e.message)})}}},x=a("h2",{class:"mb-2"}," JSTune ",-1),T=["onClick"];function C(t,e,o,l,L,i){const u=c("router-link"),f=c("TemplateSetup");return n(),$(f,null,{default:r(()=>[x,d(a("input",{ref:"username","onUpdate:modelValue":e[0]||(e[0]=s=>t.email=s),class:"mb-3 font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Username"},null,512),[[p,t.email]]),d(a("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.password=s),class:"font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Password",type:"password"},null,512),[[p,t.password]]),a("button",{onClick:e[2]||(e[2]=s=>i.login({email:t.email,password:t.password})),class:"hover:bg-fuchsia-950 mt-4 mb-2 rounded-lg bg-fuchsia-900 w-full p-3"}," Login "),(n(!0),h(k,null,b(t.providers,s=>(n(),h("button",{onClick:S=>i.redirect(s),class:"hover:bg-sky-800 bg-sky-700 mt-2 rounded-lg w-full p-3"}," Login with "+y(s),9,T))),256)),m(u,{to:"/recover",class:"hover:text-slate-200 mt-6 inline-block text-center w-full"},{default:r(()=>[g(" Recover lost password ")]),_:1}),m(u,{to:"/register",class:"mt-3 hover:text-slate-200 inline-block text-center w-full"},{default:r(()=>[g(" Request access ")]),_:1})]),_:1})}const P=v(_,[["render",C]]);export{P as default};
