import{W as v}from"./UtilityNavbar-C6Wj1Lg-.js";import b from"./TemplateDefault-C7l6K90d.js";import{S as g}from"./SectionHero-BlHhshlc.js";import{_ as w,c as y,w as n,r as i,o as _,a as d,b as s,t as c,e as m,v as f,j as $}from"./index-ApIxrpBE.js";const T={components:{WrapperPage:v,TemplateDefault:b,SectionHero:g},inject:["io"],props:["renderer"],data:()=>({command:"",address:"",output:"",autoscroll:!0,listener:null}),async created(){try{await this.inspectLeader()}catch{}console.log("Listening to terminal events"),this.listener=e=>{var t,o,l,a;((o=(t=this.$refs)==null?void 0:t.output)==null?void 0:o.scrollTop)===null||((a=(l=this.$refs)==null?void 0:l.output)==null?void 0:a.scrollHeight)===null?this.io.service("terminal").off("output",this.listener):(this.output+=`${e}
`,this.autoscroll&&(this.$refs.output.scrollTop=this.$refs.output.scrollHeight))},this.io.service("terminal").on("output",this.listener)},beforeDestroy(){this.io.service("terminal").off("output",this.listener)},methods:{async inspectLeader(){var t;const e=await this.io.service("state").get();if(e.leaderIP)this.address=e.leaderIP;else{const o=await this.io.service("docker_nodes").find({query:{leader:!0}}),l=(t=o==null?void 0:o.data)==null?void 0:t[0];l&&(this.address=l.address)}},async submit(){try{const e=await this.io.service("exec").patch({command:this.command});console.log("result",e),this.command=""}catch(e){alert(e.message)}}}},D=s("h1",{class:"font-thin text-xl lg:text-3xl xl:pl-6 w-full text-center"}," Terminal ",-1),k={class:"flex-col max-w-md place-self-center mt-8 mb-24 w-full flex md:max-w-4xl"},H=s("h1",{class:"px-4 mb-2 mt-6 font-medium text-3xl w-full"}," Execute scripts on leader node ",-1),P={class:"px-4 mb-4 mt-2 font-medium text-xl w-full"},S={class:"mt-6 relative mb-16 flex-col md:flex-row flex w-full"},C=s("div",{class:"-mb-6 bg-slate-100 -bottom-5 absolute h-0.5 left-2 right-2"},null,-1);function L(e,t,o,l,a,u){const p=i("SectionHero"),h=i("WrapperPage"),x=i("TemplateDefault");return _(),y(x,{renderer:o.renderer},{default:n(()=>[d(p,null,{default:n(()=>[D]),_:1}),d(h,{class:"flex-col"},{default:n(()=>[s("div",k,[H,s("h1",P," Leader node address: "+c(e.address),1),s("div",S,[m(s("textarea",{ref:"output",readonly:"","onUpdate:modelValue":t[0]||(t[0]=r=>e.output=r),class:"justify-start flex-col-reverse flex overflow-auto h-64 w-full p-4 rounded bg-slate-50",style:{"font-family":"monospace"}},null,512),[[f,e.output]]),C]),m(s("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.command=r),onKeypress:t[2]||(t[2]=$(r=>u.submit(),["enter"])),class:"p-4 my-4 bg-slate-50 rounded"},null,544),[[f,e.command]]),s("button",{class:"p-4 rounded bg-slate-200",onClick:t[3]||(t[3]=r=>u.submit())}," Go "),s("button",{class:"p-4 rounded bg-slate-200 my-4",onClick:t[4]||(t[4]=r=>e.autoscroll=!e.autoscroll)}," Autoscroll "+c(e.autoscroll?"on":"off"),1)])]),_:1})]),_:1},8,["renderer"])}const I=w(T,[["render",L]]);export{I as default};
