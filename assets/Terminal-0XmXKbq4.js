import{W as x}from"./UtilityNavbar-Bzd-y3VY.js";import v from"./TemplateDefault-B4YyO0ef.js";import{S as b}from"./SectionHero-DyDSvVe_.js";import{_ as w,c as g,w as a,r as n,o as y,a as d,b as s,t as u,e as c,v as m,j as _}from"./index-DSadhvFm.js";const T={components:{WrapperPage:x,TemplateDefault:v,SectionHero:b},inject:["io"],props:["renderer"],data:()=>({command:"",address:"",output:"",autoscroll:!0,listener:null}),async created(){try{await this.inspectLeader()}catch{}console.log("Listening to terminal events"),this.listener=e=>{var t,o;((o=(t=this.$refs)==null?void 0:t.output)==null?void 0:o.scrollTop)===null?this.io.service("terminal").off("output",this.listener):(this.output+=`${e}
`,this.autoscroll&&(this.$refs.output.scrollTop=this.$refs.output.scrollHeight))},this.io.service("terminal").on("output",this.listener)},beforeDestroy(){this.io.service("terminal").off("output",this.listener)},methods:{async inspectLeader(){var t;const e=await this.io.service("state").get();if(e.leaderIP)this.address=e.leaderIP;else{const o=await this.io.service("docker_nodes").find({query:{leader:!0}}),r=(t=o==null?void 0:o.data)==null?void 0:t[0];r&&(this.address=r.address)}},async submit(){try{const e=await this.io.service("exec").patch({command:this.command});console.log("result",e),this.command=""}catch(e){alert(e.message)}}}},$=s("h1",{class:"font-thin text-xl lg:text-3xl xl:pl-6 w-full text-center"}," Terminal ",-1),D={class:"flex-col max-w-md place-self-center mt-8 mb-24 w-full flex md:max-w-4xl"},k=s("h1",{class:"px-4 mb-2 mt-6 font-medium text-3xl w-full"}," Execute scripts on leader node ",-1),P={class:"px-4 mb-4 mt-2 font-medium text-xl w-full"},S={class:"mt-6 relative mb-16 flex-col md:flex-row flex w-full"},C=s("div",{class:"-mb-6 bg-slate-100 -bottom-5 absolute h-0.5 left-2 right-2"},null,-1);function H(e,t,o,r,L,i){const f=n("SectionHero"),p=n("WrapperPage"),h=n("TemplateDefault");return y(),g(h,{renderer:o.renderer},{default:a(()=>[d(f,null,{default:a(()=>[$]),_:1}),d(p,{class:"flex-col"},{default:a(()=>[s("div",D,[k,s("h1",P," Leader node address: "+u(e.address),1),s("div",S,[c(s("textarea",{ref:"output",readonly:"","onUpdate:modelValue":t[0]||(t[0]=l=>e.output=l),class:"justify-start flex-col-reverse flex overflow-auto h-64 w-full p-4 rounded bg-slate-50",style:{"font-family":"monospace"}},null,512),[[m,e.output]]),C]),c(s("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>e.command=l),onKeypress:t[2]||(t[2]=_(l=>i.submit(),["enter"])),class:"p-4 my-4 bg-slate-50 rounded"},null,544),[[m,e.command]]),s("button",{class:"p-4 rounded bg-slate-200",onClick:t[3]||(t[3]=l=>i.submit())}," Go "),s("button",{class:"p-4 rounded bg-slate-200 my-4",onClick:t[4]||(t[4]=l=>e.autoscroll=!e.autoscroll)}," Autoscroll "+u(e.autoscroll?"on":"off"),1)])]),_:1})]),_:1},8,["renderer"])}const I=w(T,[["render",H]]);export{I as default};
